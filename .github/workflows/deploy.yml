name: Create env.js

on:
  push:
    branches: [main]

jobs:
  create-env:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Checkout repository
      - name: Checkout code
        uses: actions/checkout@v3

      # 2️⃣ Create env.js with hardcoded Firebase config
      - name: Create env.js
        run: |
          mkdir -p projects/telegrammsg/src/assets
          echo "window.env = {" > projects/telegrammsg/src/assets/env.js
          echo "  firebase: {" >> projects/telegrammsg/src/assets/env.js
          echo "    apiKey: 'hardcoded_api_key'," >> projects/telegrammsg/src/assets/env.js
          echo "    authDomain: 'hardcoded_project.firebaseapp.com'," >> projects/telegrammsg/src/assets/env.js
          echo "    projectId: 'hardcoded_project'," >> projects/telegrammsg/src/assets/env.js
          echo "    storageBucket: 'hardcoded_project.appspot.com'," >> projects/telegrammsg/src/assets/env.js
          echo "    messagingSenderId: 'hardcoded_sender_id'," >> projects/telegrammsg/src/assets/env.js
          echo "    appId: 'hardcoded_app_id'" >> projects/telegrammsg/src/assets/env.js
          echo "  }" >> projects/telegrammsg/src/assets/env.js
          echo "};" >> projects/telegrammsg/src/assets/env.js

      # 3️⃣ Debug: show the env.js content
      - name: Verify env.js
        run: cat projects/telegrammsg/src/assets/env.js || echo "❌ env.js not found"
